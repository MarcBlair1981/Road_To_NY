<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dice Boardgame â€” 30-Day Simulator</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header>
    <h1>ðŸŽ² Dice Boardgame â€” 30-Day Simulator (No Python Needed)</h1>
  </header>
  <main>
    <div class="grid">
      <section class="card">
        <h2 style="margin-top:0;">Inputs</h2>
        <div class="row">
          <label for="rollsPerSession"># rolls per session</label>
          <input id="rollsPerSession" type="number" min="1" max="10" step="1" value="1" />
        </div>
        <div class="row">
          <label for="sessionsPerDay">Sessions per day</label>
          <input id="sessionsPerDay" type="number" min="1" max="24" step="1" value="1" />
        </div>
        <div class="row">
          <label for="numUsers">Expected number of users</label>
          <input id="numUsers" type="number" min="10" max="1000000" step="10" value="1000" />
        </div>
        <div class="row">
          <label for="participation">Daily participation per session (%)</label>
          <div class="flex">
            <input id="participation" type="range" min="0" max="100" step="1" value="100" />
            <span id="partVal" class="pill">100%</span>
          </div>
        </div>
        <div class="row">
          <label for="doubleSix">Double roll on six (explode)</label>
          <input id="doubleSix" type="checkbox" checked />
        </div>
        <div class="row">
          <label for="leaderboard">Show Day-30 leaderboard</label>
          <input id="leaderboard" type="checkbox" checked />
        </div>
        <div class="row">
          <label for="seed">Simulation Variant</label>
          <input id="seed" type="number" step="1" value="42" />
        </div>
        <div class="help">
          Defaults: rolls/session=1, sessions/day=1, users=1000, participation=100%, explode=ON, leaderboard=ON,
          seed=42.
        </div>
        <div class="actions" style="margin-top:10px;">
          <button id="run" class="primary">Run Simulation (30 days)</button>
          <button id="dlPositions" disabled>Download positions.csv</button>
          <button id="dlMilestones" disabled>Download milestones.csv</button>
          <button id="dlLeaderboard" disabled>Download leaderboard.csv</button>
          <button id="dlDetailed" disabled>Download detailed_history.csv</button>
        </div>
      </section>

      <section class="card">
        <h2 style="margin-top:0;">Quick Stats</h2>
        <div id="stats"></div>
        <div class="help">We show mean, std, min, quartiles, max for days 7/14/21/30 across users.</div>
      </section>
    </div>

    <section class="card" style="margin-top:16px;">
      <h2 style="margin-top:0;">Distributions (Positions after D days)</h2>
      <div class="grid">
        <div>
          <div class="flex"><span class="pill">Day 7</span><span id="count7" class="pill"></span></div>
          <canvas id="hist7" width="520" height="240"></canvas>
        </div>
        <div>
          <div class="flex"><span class="pill">Day 14</span><span id="count14" class="pill"></span></div>
          <canvas id="hist14" width="520" height="240"></canvas>
        </div>
        <div>
          <div class="flex"><span class="pill">Day 21</span><span id="count21" class="pill"></span></div>
          <canvas id="hist21" width="520" height="240"></canvas>
        </div>
        <div>
          <div class="flex"><span class="pill">Day 30</span><span id="count30" class="pill"></span></div>
          <canvas id="hist30" width="520" height="240"></canvas>
        </div>
      </div>
    </section>

    <!-- User Inspector Section -->
    <section class="card" style="margin-top:16px;">
      <h2 style="margin-top:0;">User Inspector</h2>
      <div class="row" style="max-width: 400px;">
        <label for="inspectUserId">User ID (1 - <span id="maxUserLabel">1000</span>)</label>
        <div class="flex">
          <input id="inspectUserId" type="number" min="1" step="1" placeholder="e.g. 42" />
          <button id="btnInspect">Lookup</button>
        </div>
      </div>
      <div id="inspectorError" style="color:#ff6b6b; margin-bottom:10px; display:none;"></div>

      <div id="inspectorResults" style="display:none;">
        <h3 id="inspectorHeader" style="margin-bottom:8px;">User #42 History</h3>
        <div style="max-height: 400px; overflow-y: auto; border: 1px solid #243047; border-radius: 10px;">
          <table id="inspectorTable" style="margin-top:0;">
            <thead style="position:sticky; top:0;">
              <tr>
                <th>Day</th>
                <th>Time</th>
                <th>Start Pos</th>
                <th>Rolls</th>
                <th>Steps</th>
                <th>Items</th>
                <th>End Pos</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="card" id="leaderboardCard" style="margin-top:16px; display:none;">
      <h2 style="margin-top:0;">Leaderboard â€” Day 30 (Top 20)</h2>
      <div id="board"></div>
    </section>


    <div class="footer">
      Method: sessions/day Ã— participation Ã— (sum of dice per session), accumulated across days. Exploding-six increases
      mean and variance.
    </div>
  </main>
  <script src="script.js"></script>
</body>

</html>